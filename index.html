<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>
      Resource Timing Level 2
    </title>
    <script src='https://www.w3.org/Tools/respec/respec-w3c' class='remove'
    defer></script>
    <script class='remove'>
    var respecConfig = {
    shortName: "resource-timing-2",
    specStatus: "ED",
    editors: [{
      name: "Yoav Weiss",
      url: "https://blog.yoav.ws/",
      company: "Google",
      companyURL: "https://google.com/",
      w3cid: "58673"
    }, {
      name: "Noam Rosenthal",
      mailto: "noam.j.rosenthal@gmail.com",
      company: "Invited Expert",
      w3cid: "121539"
    }],
    formerEditors: [{
      name: "Ilya Grigorik",
      url: "https://www.igvita.com/",
      company: "Google",
      companyURL: "https://google.com/",
      note: "Until January 2021",
      w3cid: "56102"
    }, {
      name: "Todd Reifsteck",
      mailto: "toddreif@microsoft.com",
      company: "Microsoft Corp.",
      note: "Until January 2021",
      w3cid: "76565"
    }, {
      name: "Arvind Jain",
      mailto: "arvind@google.com",
      company: "Google Inc.",
      note: "Until December 2014",
      w3cid: "45188"
    }, {
      name: "Jatinder Mann",
      mailto: "jmann@microsoft.com",
      company: "Microsoft Corp.",
      note: "Until February 2014",
      w3cid: "44357"
    }, {
      name: "Zhiheng Wang",
      company: "Google Inc.",
      note: "Until July 2012",
      w3cid: "43685"
    }, {
      name: "Anderson Quach",
      company: "Microsoft Corp.",
      note: "Until March 2011",
      w3cid: "45288"
    }],
    group:"webperf",
    wgPublicList: "public-web-perf",
    subjectPrefix: "[ResourceTiming]",
    github: "https://github.com/w3c/resource-timing/",
    caniuse: "resource-timing",
    xref: ["html", "hr-time-3", "performance-timeline-2", "fetch", "infra"],
    };
    </script>
  </head>
  <body>
    <section id="abstract">
      <p>
        This specification defines an interface for web applications to access
        the complete timing information for resources in a document.
      </p>
    </section>
    <section id="sotd">
      <p class='warning'>
        Implementers SHOULD be aware that this document is not stable.
        Implementers who are not taking part in the discussions are likely to
        find the specification changing out from under them in incompatible
        ways. Vendors interested in implementing this document before it
        eventually reaches the Candidate Recommendation stage SHOULD join the
        aforementioned mailing lists and take part in the discussions.
      </p>
    </section>
    <section id="introduction" class='informative'>
      <h2>
        Introduction
      </h2>
      <p>
        User latency is an important quality benchmark for Web Applications.
        While JavaScript-based mechanisms can provide comprehensive
        instrumentation for user latency measurements within an application, in
        many cases, they are unable to provide a complete end-to-end latency
        picture. This document introduces the <a>PerformanceResourceTiming</a>
        interface to allow JavaScript mechanisms to collect complete timing
        information related to resources on a document. Navigation Timing 2
        [[NAVIGATION-TIMING-2]] extends this specification to provide
        additional timing information associated with a navigation.
      </p>
      <p>
        For example, the following JavaScript shows a simple attempt to measure
        the time it takes to fetch a resource:
      </p>
      <pre class='example html'>
        &lt;!doctype html&gt;
        &lt;html&gt;
          &lt;head&gt;
          &lt;/head&gt;
          &lt;body onload="loadResources()"&gt;
            &lt;script&gt;
                function loadResources()
                {
                  var start = new Date().getTime();
                  var image1 = new Image();
                  var resourceTiming = function() {
                      var now = new Date().getTime();
                      var latency = now - start;
                      alert("End to end resource fetch: " + latency);
                  };

                  image1.onload = resourceTiming;
                  image1.src = 'https://www.w3.org/Icons/w3c_main.png';
                }
            &lt;/script&gt;
            &lt;img src="https://www.w3.org/Icons/w3c_home.png"&gt;
          &lt;/body&gt;
        &lt;/html&gt;
        </pre>
      <p>
        Though this script can measure the time it takes to fetch a resource,
        it cannot break down the time spent in various phases. Further, the
        script cannot easily measure the time it takes to fetch resources
        described in markup.
      </p>
      <p>
        To address the need for complete information on user experience, this
        document introduces the <a>PerformanceResourceTiming</a> interface.
        This interface allows JavaScript mechanisms to provide complete
        client-side latency measurements within applications. With this
        interface, the previous example can be modified to measure a user's
        perceived load time of a resource.
      </p>
      <p>
        The following script calculates the amount of time it takes to fetch
        every resource in the page, even those defined in markup. This example
        assumes that this page is hosted on https://www.w3.org. One could
        further measure the amount of time it takes in every phase of fetching
        a resource with the <a>PerformanceResourceTiming</a> interface.
      </p>
      <pre class='example html'>
        &lt;!doctype html&gt;
        &lt;html&gt;
          &lt;head&gt;
          &lt;/head&gt;
          &lt;body onload="loadResources()"&gt;
            &lt;script&gt;
              function loadResources()
              {
                  var image1 = new Image();
                  image1.onload = resourceTiming;
                  image1.src = 'https://www.w3.org/Icons/w3c_main.png';
              }
</html>
